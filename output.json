{
  "meta":{
    "timestamp":"2024-05-16T08:21:54.658582",
    "version":"7.0.1",
    "argv":[
      "samples/infected.exe",
      "-r",
      "capa_rules",
      "-s",
      "capa_sigs",
      "-j",
      "-q"
    ],
    "sample":{
      "md5":"8eb6ed01392a5cbba283febd7c9aa16a",
      "sha1":"d472f8b50f8a9a6e583262f326a57927d9df940c",
      "sha256":"b2e85f5907f28c7c9bfc0370be2567494e0fd11887dfc80ca62958d4f5fbf8a0",
      "path":"/home/peacekeeper/projetos/malan/samples/infected.exe"
    },
    "flavor":"static",
    "analysis":{
      "format":"pe",
      "arch":"amd64",
      "os":"any",
      "extractor":"DnfileFeatureExtractor",
      "rules":[
        "/home/peacekeeper/projetos/malan/capa_rules"
      ],
      "base_address":{
        "type":"no address"
      },
      "layout":{
        "functions":[
          {
            "address":{
              "type":"dn token",
              "value":100663297
            },
            "matched_basic_blocks":[
              {
                "address":{
                  "type":"dn token",
                  "value":100663297
                }
              }
            ]
          },
          {
            "address":{
              "type":"dn token",
              "value":100663306
            },
            "matched_basic_blocks":[
              {
                "address":{
                  "type":"dn token",
                  "value":100663306
                }
              }
            ]
          },
          {
            "address":{
              "type":"dn token",
              "value":100663309
            },
            "matched_basic_blocks":[
              {
                "address":{
                  "type":"dn token",
                  "value":100663309
                }
              }
            ]
          },
          {
            "address":{
              "type":"dn token",
              "value":100663312
            },
            "matched_basic_blocks":[
              {
                "address":{
                  "type":"dn token",
                  "value":100663312
                }
              }
            ]
          }
        ]
      },
      "feature_counts":{
        "file":8391,
        "functions":[
          {
            "address":{
              "type":"dn token",
              "value":100663297
            },
            "count":47
          },
          {
            "address":{
              "type":"dn token",
              "value":100663298
            },
            "count":4
          },
          {
            "address":{
              "type":"dn token",
              "value":100663299
            },
            "count":4
          },
          {
            "address":{
              "type":"dn token",
              "value":100663300
            },
            "count":4
          },
          {
            "address":{
              "type":"dn token",
              "value":100663301
            },
            "count":16
          },
          {
            "address":{
              "type":"dn token",
              "value":100663302
            },
            "count":5
          },
          {
            "address":{
              "type":"dn token",
              "value":100663303
            },
            "count":13
          },
          {
            "address":{
              "type":"dn token",
              "value":100663304
            },
            "count":11
          },
          {
            "address":{
              "type":"dn token",
              "value":100663305
            },
            "count":16
          },
          {
            "address":{
              "type":"dn token",
              "value":100663306
            },
            "count":139
          },
          {
            "address":{
              "type":"dn token",
              "value":100663307
            },
            "count":14
          },
          {
            "address":{
              "type":"dn token",
              "value":100663308
            },
            "count":16
          },
          {
            "address":{
              "type":"dn token",
              "value":100663309
            },
            "count":146
          },
          {
            "address":{
              "type":"dn token",
              "value":100663310
            },
            "count":14
          },
          {
            "address":{
              "type":"dn token",
              "value":100663311
            },
            "count":14
          },
          {
            "address":{
              "type":"dn token",
              "value":100663312
            },
            "count":10
          },
          {
            "address":{
              "type":"dn token",
              "value":100663313
            },
            "count":8
          },
          {
            "address":{
              "type":"dn token",
              "value":100663314
            },
            "count":22
          },
          {
            "address":{
              "type":"dn token",
              "value":100663315
            },
            "count":16
          },
          {
            "address":{
              "type":"dn token",
              "value":100663316
            },
            "count":65
          },
          {
            "address":{
              "type":"dn token",
              "value":100663317
            },
            "count":8
          },
          {
            "address":{
              "type":"dn token",
              "value":100663318
            },
            "count":20
          },
          {
            "address":{
              "type":"dn token",
              "value":100663319
            },
            "count":8
          },
          {
            "address":{
              "type":"dn token",
              "value":100663320
            },
            "count":8
          },
          {
            "address":{
              "type":"dn token",
              "value":100663321
            },
            "count":15
          }
        ]
      },
      "library_functions":[ ]
    }
  },
  "rules":{
    "load .NET assembly":{
      "meta":{
        "name":"load .NET assembly",
        "namespace":"load-code/dotnet",
        "authors":[
          "anushka.virgaonkar@mandiant.com"
        ],
        "scopes":{
          "static":"function",
          "dynamic":"call"
        },
        "attack":[
          {
            "parts":[
              "Defense Evasion",
              "Reflective Code Loading"
            ],
            "tactic":"Defense Evasion",
            "technique":"Reflective Code Loading",
            "subtechnique":"",
            "id":"T1620"
          }
        ],
        "mbc":[ ],
        "references":[ ],
        "examples":[ ],
        "description":"",
        "lib":false,
        "is_subscope_rule":false,
        "maec":{ }
      },
      "source":"rule:\n  meta:\n    name: load .NET assembly\n    namespace: load-code/dotnet\n    authors:\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: call\n    att&ck:\n      - Defense Evasion::Reflective Code Loading [T1620]\n  features:\n    - or:\n      - api: System.Reflection.Assembly::Load\n      - api: System.AppDomain::Load\n      - api: System.Reflection.Assembly::LoadFile\n      - api: System.Reflection.Assembly::LoadFrom\n      - api: System.Reflection.Assembly::LoadWithPartialName\n      - api: System.Reflection.Assembly::ReflectionOnlyLoad\n      - api: System.Reflection.Assembly::ReflectionOnlyLoadFrom\n      - api: System.Reflection.Assembly::UnsafeLoadFrom\n",
      "matches":[
        [
          {
            "type":"dn token",
            "value":100663297
          },
          {
            "success":true,
            "node":{
              "type":"statement",
              "statement":{
                "type":"or"
              }
            },
            "children":[
              {
                "success":true,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Reflection.Assembly::Load"
                  }
                },
                "children":[ ],
                "locations":[
                  {
                    "type":"dn token offset",
                    "value":[
                      100663297,
                      75
                    ]
                  }
                ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.AppDomain::Load"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Reflection.Assembly::LoadFile"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Reflection.Assembly::LoadFrom"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Reflection.Assembly::LoadWithPartialName"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Reflection.Assembly::ReflectionOnlyLoad"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Reflection.Assembly::ReflectionOnlyLoadFrom"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Reflection.Assembly::UnsafeLoadFrom"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              }
            ],
            "locations":[ ],
            "captures":{ }
          }
        ]
      ]
    },
    "terminate process":{
      "meta":{
        "name":"terminate process",
        "namespace":"host-interaction/process/terminate",
        "authors":[
          "moritz.raabe@mandiant.com",
          "michael.hunhoff@mandiant.com",
          "anushka.virgaonkar@mandiant.com"
        ],
        "scopes":{
          "static":"function",
          "dynamic":"thread"
        },
        "attack":[ ],
        "mbc":[
          {
            "parts":[
              "Process",
              "Terminate Process"
            ],
            "objective":"Process",
            "behavior":"Terminate Process",
            "method":"",
            "id":"C0018"
          }
        ],
        "references":[ ],
        "examples":[
          "C91887D861D9BD4A5872249B641BC9F9:0x401A77",
          "9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307"
        ],
        "description":"",
        "lib":false,
        "is_subscope_rule":false,
        "maec":{ }
      },
      "source":"rule:\n  meta:\n    name: terminate process\n    namespace: host-interaction/process/terminate\n    authors:\n      - moritz.raabe@mandiant.com\n      - michael.hunhoff@mandiant.com\n      - anushka.virgaonkar@mandiant.com\n    scopes:\n      static: function\n      dynamic: thread\n    mbc:\n      - Process::Terminate Process [C0018]\n    examples:\n      - C91887D861D9BD4A5872249B641BC9F9:0x401A77\n      - 9B7CCAA2AE6A5B96E3110EBCBC4311F6:0x10010307\n  features:\n    - or:\n      - api: System.Diagnostics.Process::Kill\n      - api: System.Diagnostics.Process::WaitForExit\n      - api: System.Diagnostics.Process::WaitForExitAsync\n      - api: System.Environment::Exit\n      - api: System.Windows.Forms.Application::Exit\n      - api: exit\n      - api: Exit\n      - and:\n        - optional:\n          - match: open process\n        - or:\n          - api: kernel32.TerminateProcess\n          - api: ntdll.NtTerminateProcess\n          - api: kernel32.ExitProcess\n",
      "matches":[
        [
          {
            "type":"dn token",
            "value":100663297
          },
          {
            "success":true,
            "node":{
              "type":"statement",
              "statement":{
                "type":"or"
              }
            },
            "children":[
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Diagnostics.Process::Kill"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Diagnostics.Process::WaitForExit"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Diagnostics.Process::WaitForExitAsync"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":true,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Environment::Exit"
                  }
                },
                "children":[ ],
                "locations":[
                  {
                    "type":"dn token offset",
                    "value":[
                      100663297,
                      180
                    ]
                  }
                ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"System.Windows.Forms.Application::Exit"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"exit"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"api",
                    "api":"Exit"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"statement",
                  "statement":{
                    "type":"and"
                  }
                },
                "children":[
                  {
                    "success":true,
                    "node":{
                      "type":"statement",
                      "statement":{
                        "type":"optional"
                      }
                    },
                    "children":[
                      {
                        "success":false,
                        "node":{
                          "type":"feature",
                          "feature":{
                            "type":"match",
                            "match":"open process"
                          }
                        },
                        "children":[ ],
                        "locations":[ ],
                        "captures":{ }
                      }
                    ],
                    "locations":[ ],
                    "captures":{ }
                  },
                  {
                    "success":false,
                    "node":{
                      "type":"statement",
                      "statement":{
                        "type":"or"
                      }
                    },
                    "children":[
                      {
                        "success":false,
                        "node":{
                          "type":"feature",
                          "feature":{
                            "type":"api",
                            "api":"TerminateProcess"
                          }
                        },
                        "children":[ ],
                        "locations":[ ],
                        "captures":{ }
                      },
                      {
                        "success":false,
                        "node":{
                          "type":"feature",
                          "feature":{
                            "type":"api",
                            "api":"NtTerminateProcess"
                          }
                        },
                        "children":[ ],
                        "locations":[ ],
                        "captures":{ }
                      },
                      {
                        "success":false,
                        "node":{
                          "type":"feature",
                          "feature":{
                            "type":"api",
                            "api":"ExitProcess"
                          }
                        },
                        "children":[ ],
                        "locations":[ ],
                        "captures":{ }
                      }
                    ],
                    "locations":[ ],
                    "captures":{ }
                  }
                ],
                "locations":[ ],
                "captures":{ }
              }
            ],
            "locations":[ ],
            "captures":{ }
          }
        ]
      ]
    },
    "access .NET resource":{
      "meta":{
        "name":"access .NET resource",
        "namespace":"executable/resource",
        "authors":[
          "@mr-tz"
        ],
        "scopes":{
          "static":"function",
          "dynamic":"thread"
        },
        "attack":[ ],
        "mbc":[ ],
        "references":[ ],
        "examples":[
          "387f15043f0198fd3a637b0758c2b6dde9ead795c3ed70803426fc355731b173:0x06000084"
        ],
        "description":"",
        "lib":false,
        "is_subscope_rule":false,
        "maec":{ }
      },
      "source":"rule:\n  meta:\n    name: access .NET resource\n    namespace: executable/resource\n    authors:\n      - \"@mr-tz\"\n    scopes:\n      static: function\n      dynamic: thread\n    examples:\n      - 387f15043f0198fd3a637b0758c2b6dde9ead795c3ed70803426fc355731b173:0x06000084\n  features:\n    - and:\n      - format: dotnet\n      - or:\n        - api: System.Resources.ResourceManager::ctor\n        - api: System.Reflection.Assembly::GetManifestResourceStream\n",
      "matches":[
        [
          {
            "type":"dn token",
            "value":100663318
          },
          {
            "success":true,
            "node":{
              "type":"statement",
              "statement":{
                "type":"and"
              }
            },
            "children":[
              {
                "success":true,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"format",
                    "format":"dotnet"
                  }
                },
                "children":[ ],
                "locations":[
                  {
                    "type":"no address"
                  }
                ],
                "captures":{ }
              },
              {
                "success":true,
                "node":{
                  "type":"statement",
                  "statement":{
                    "type":"or"
                  }
                },
                "children":[
                  {
                    "success":true,
                    "node":{
                      "type":"feature",
                      "feature":{
                        "type":"api",
                        "api":"System.Resources.ResourceManager::ctor"
                      }
                    },
                    "children":[ ],
                    "locations":[
                      {
                        "type":"dn token offset",
                        "value":[
                          100663318,
                          34
                        ]
                      }
                    ],
                    "captures":{ }
                  },
                  {
                    "success":false,
                    "node":{
                      "type":"feature",
                      "feature":{
                        "type":"api",
                        "api":"System.Reflection.Assembly::GetManifestResourceStream"
                      }
                    },
                    "children":[ ],
                    "locations":[ ],
                    "captures":{ }
                  }
                ],
                "locations":[ ],
                "captures":{ }
              }
            ],
            "locations":[ ],
            "captures":{ }
          }
        ]
      ]
    },
    "compiled to the .NET platform":{
      "meta":{
        "name":"compiled to the .NET platform",
        "namespace":"runtime/dotnet",
        "authors":[
          "william.ballenthin@mandiant.com"
        ],
        "scopes":{
          "static":"file",
          "dynamic":"file"
        },
        "attack":[ ],
        "mbc":[ ],
        "references":[ ],
        "examples":[
          "b9f5bd514485fb06da39beff051b9fdc"
        ],
        "description":"",
        "lib":false,
        "is_subscope_rule":false,
        "maec":{ }
      },
      "source":"rule:\n  meta:\n    name: compiled to the .NET platform\n    namespace: runtime/dotnet\n    authors:\n      - william.ballenthin@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - b9f5bd514485fb06da39beff051b9fdc\n  features:\n    - or:\n      - format: dotnet\n      - import: mscoree._CorExeMain\n      - import: mscoree._corexemain\n      - import: mscoree._CorDllMain\n      - import: mscoree._cordllmain\n",
      "matches":[
        [
          {
            "type":"no address"
          },
          {
            "success":true,
            "node":{
              "type":"statement",
              "statement":{
                "type":"or"
              }
            },
            "children":[
              {
                "success":true,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"format",
                    "format":"dotnet"
                  }
                },
                "children":[ ],
                "locations":[
                  {
                    "type":"no address"
                  }
                ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"import",
                    "import_":"mscoree._CorExeMain"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"import",
                    "import_":"mscoree._corexemain"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"import",
                    "import_":"mscoree._CorDllMain"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              },
              {
                "success":false,
                "node":{
                  "type":"feature",
                  "feature":{
                    "type":"import",
                    "import_":"mscoree._cordllmain"
                  }
                },
                "children":[ ],
                "locations":[ ],
                "captures":{ }
              }
            ],
            "locations":[ ],
            "captures":{ }
          }
        ]
      ]
    },
    "contains PDB path":{
      "meta":{
        "name":"contains PDB path",
        "namespace":"executable/pe/pdb",
        "authors":[
          "moritz.raabe@mandiant.com"
        ],
        "scopes":{
          "static":"file",
          "dynamic":"file"
        },
        "attack":[ ],
        "mbc":[ ],
        "references":[ ],
        "examples":[
          "464EF2CA59782CE697BC329713698CCC"
        ],
        "description":"",
        "lib":false,
        "is_subscope_rule":false,
        "maec":{ }
      },
      "source":"rule:\n  meta:\n    name: contains PDB path\n    namespace: executable/pe/pdb\n    authors:\n      - moritz.raabe@mandiant.com\n    scopes:\n      static: file\n      dynamic: file\n    examples:\n      - 464EF2CA59782CE697BC329713698CCC  # level32.exe\n  features:\n    - string: /:\\\\.*\\.pdb/\n",
      "matches":[
        [
          {
            "type":"no address"
          },
          {
            "success":true,
            "node":{
              "type":"feature",
              "feature":{
                "type":"regex",
                "regex":"/:\\\\.*\\.pdb/"
              }
            },
            "children":[ ],
            "locations":[
              {
                "type":"file",
                "value":732704
              }
            ],
            "captures":{
              "C:\\Users\\Administrator\\AppData\\Local\\Temporary Projects\\DynamicLayout\\obj\\Debug\\Layout.pdb":[
                {
                  "type":"file",
                  "value":732704
                }
              ]
            }
          }
        ]
      ]
    }
  }
}